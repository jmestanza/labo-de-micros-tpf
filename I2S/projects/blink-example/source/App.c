/***************************************************************************//**
  @file     App.c
  @brief    Application functions
  @author   Nicolás Magliola
 ******************************************************************************/

/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/

#include "board.h"
#include "gpio.h"
#include "i2s.h"
#include "DMA.h"

/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/


/*******************************************************************************
 * FUNCTION PROTOTYPES FOR PRIVATE FUNCTIONS WITH FILE LEVEL SCOPE
 ******************************************************************************/
// 4294967295 = 0x FF FF FF FF
// 2694881440 = 0x A0 A0 A0 A0

//static uint32_t data[] = {4294967295, 0 , 2694881440, 0 };

//uint32_t data[16] __attribute__((aligned(4))) =
//{
//		0, 2, 4, 6, // 4 samples
//		8,10,12,14,
//		1,3,5,7,
//		9,11,13,15
//};

uint32_t data[16] __attribute__((aligned(4))) =
{
		16, 2, 4, 6, // 4 samples
		8,10,12,14,
		1,3,5,7,
		9,11,13,15
};


static uint32_t dst[16] __attribute__((aligned(4))) =
{
		0, 0, 0, 0, // 4 samples
		0, 0, 0, 0,
		0, 0, 0, 0,
		0, 0, 0, 0
};

/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

void process(void){ // this function is called when DMA has transfered one block (half of the total)

}



/* Función que se llama 1 vez, al comienzo del programa */


void App_Init (void)
{
    //gpioMode(PIN_LED_BLUE, OUTPUT);
    i2s_init();
    DMA0_Config(process); // 4 samples , 4 bytes (uint32_t)

//    DMA0_ConfigPingPongBuffer(4, 4, data, dst);
    DMA0_ConfigClassic(4, 4, data, dst);
    DMA0_EnableRequest();
}



/* Función que se llama constantemente en un ciclo infinito */
void App_Run (void)
{
	//DMA0_GenerateRequest();
}


/*******************************************************************************
 *******************************************************************************
                        LOCAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/


/*******************************************************************************
 ******************************************************************************/
